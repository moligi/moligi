<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>DatePicker Nuwu</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tachyons/4.9.1/tachyons.min.css" />
    
  </head>
  <body>
    <div class="w-100 tc">
      <div id="example" class="pa3">
      </div>
    </div>
    <script src="example.js"></script>
<script type="text/javascript">
  Array.prototype.slice
    .apply(document.getElementsByClassName("example"))
    .forEach(function (ex) {
      ex.addEventListener("click", function (e) {
        Elm[e.target.hash.slice(1)].embed(document.getElementById("example"));
         console.log(ex);
         console.log(document.getElementById("example"));
      });
    });
  // initially render the "Styled" example to avoid "blank page" on initial page load:
  Elm['Range'].embed(document.getElementById("example"));
  console.log(( "#title" ).val())
  
  
            (function (d, s, id) {
              var js, fjs = d.getElementsByTagName(s)[0];
              if (d.getElementById(id)) {
                  return;
              }
              js = d.createElement(s);
              js.id = id;
              js.src = "//connect.facebook.com/en_US/messenger.Extensions.js";
              fjs.parentNode.insertBefore(js, fjs);
              }(document, 'script', 'Messenger'));
       
         window.extAsyncInit = function () {
              // SDK loaded, code to follow
              var isSupported = MessengerExtensions.isInExtension(); 
              //alert('Is MessengerExtensions supported: ' + isSupported);
              MessengerExtensions.getSupportedFeatures(function success(result) {
                  let features = result.supported_features;
                   //alert('Supported Facebook Features: ' + features);
                     MessengerExtensions.getContext('214020109069642',
                       function success(thread_context) {
                        // success
                        //document.getElementById("psid").value = thread_context.psid;
                        //alert('PSID of current thread: ' + thread_context.psid);
                        
                        // More code to follow
                      },
                      function error(err) {
                        alert(err);
                      }
                    );
                  
                }, function error(err) {
                  alert(err);
                });
            };
       
       function sendMessage(){
                     //alert('sendMessage Starts');
                     let message = {
                        "attachment":{
                          "type":"template",
                          "payload":{
                            "template_type":"generic",
                            "elements": [{
                              "title":"Selected days for vacation",
                              "image_url": "https://www.libertytravel.com/sites/default/files/styles/full_size/public/vacation-hero.jpg?itok=IEwJw6L-",
                              "subtitle": "From ",
                            }]
                          }
                        }
                      };
                     MessengerExtensions.beginShareFlow(function(share_response) {
                        // User dismissed without error, but did they share the message?
                        //alert('beginShareFlow starts');
                        //var message = $( "#from_field_id" ).val();
                        if(share_response.is_sent){
                        //alert('share response sent');
                        // The user actually did share. 
                        // Perhaps close the window w/ requestCloseBrowser().
                                MessengerExtensions.requestCloseBrowser(function success() {
                                 //alert('requestCloseBrowser');
                                 //alert($( "#from_field_id" ).val());
                                 //alert($( "#to_field_id" ).val());
                              }, function error(err) {
                                    alert(err);
                        });             
                       }
                      }, 
                        function(errorCode, errorMessage) {      
                          // An error occurred in the process

                        },
                          message,
                          "current_thread");
         
        }
  
    
 
  </script>


    

      
    
      
    <p id="demo"></p>
    <p id="demo2"></p>
    <button type="button" id="submit_button" onclick="sendMessage();">確認</button> 
    
  </body>
</html>
