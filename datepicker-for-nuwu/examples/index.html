<!DOCTYPE html>

<html lang="en" dir="ltr">

	<head>
	        <meta charset="utf-8">
		<title>Date Picker</title>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tachyons/4.9.1/tachyons.min.css" />
    
    
    		
	</head>
	
	<body>
		<div class="w-100 tc">
      <div id="example" class="pa3">
      </div>
    </div>
   <script src="example.js"></script>
   <script type="text/javascript">
        Array.prototype.slice
          .apply(document.getElementsByClassName("example"))
          .forEach(function (ex) {
            ex.addEventListener("click", function (e) {
              Elm[e.target.hash.slice(1)].embed(document.getElementById("example"));
            });
          });
        // initially render the "Styled" example to avoid "blank page" on initial page load:
        Elm['Range'].embed(document.getElementById("example"));
			       function test(){
       }
	   </script>
		<script>
          (function (d, s, id) {
              var js, fjs = d.getElementsByTagName(s)[0];
              if (d.getElementById(id)) {
                  return;
              }
              js = d.createElement(s);
              js.id = id;
              js.src = "//connect.facebook.com/en_US/messenger.Extensions.js";
              fjs.parentNode.insertBefore(js, fjs);
              }(document, 'script', 'Messenger'));
       
         window.extAsyncInit = function () {
              // SDK loaded, code to follow
              var isSupported = MessengerExtensions.isInExtension(); 
              //alert('Is MessengerExtensions supported: ' + isSupported);
              MessengerExtensions.getSupportedFeatures(function success(result) {
                  let features = result.supported_features;
                   //alert('Supported Facebook Features: ' + features);
                     MessengerExtensions.getContext('214020109069642',
                       function success(thread_context) {
                        // success
                        //document.getElementById("psid").value = thread_context.psid;
                        //alert('PSID of current thread: ' + thread_context.psid);
                        
                        // More code to follow
                      },
                      function error(err) {
                        alert(err);
                      }
                    );
                  
                }, function error(err) {
                  alert(err);
                });
            };
       
       function sendMessage(){
       
                     //alert('sendMessage Starts');
	              var yearMOnth =  document.getElementsByClassName("tc")[1].innerHTML;
       Date.prototype.Format = function (fmt) { 
    var o = {
        "M+": this.getMonth() + 1, //月份
        "d+": this.getDate(), //日
        "h+": this.getHours(), //小时
        "m+": this.getMinutes(), //分
        "s+": this.getSeconds(), //秒
        "q+": Math.floor((this.getMonth() + 3) / 3), //季度
        "S": this.getMilliseconds() //毫秒
    };
    if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
    for (var k in o)
    if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
    return fmt;
}
       var monthAndYear =  document.getElementsByClassName("tc")[1].innerHTML;
       var dateFrom = document.getElementsByClassName("pa1 bg-dark-red white selected bg-dark-red white")[0].innerHTML
       var dateEnd = document.getElementsByClassName("pa1 bg-dark-red white selected bg-dark-red white")[1].innerHTML
        dateFrom = new Date(dateFrom + " " + monthAndYear);
	dateFrom = dateFrom.Format("yyyy-MM-dd");
        dateEnd =  new Date(dateEnd + " " + monthAndYear);
	dateEnd = dateEnd.Format("yyyy-MM-dd");
        let message = {
                        "text":dateFrom + "~" + dateEnd
                      };
                     MessengerExtensions.beginShareFlow(function(share_response) {
                        // User dismissed without error, but did they share the message?
                        //alert('beginShareFlow starts');
                        //var message = $( "#from_field_id" ).val();
                        if(share_response.is_sent){
                        //alert('share response sent');
                        // The user actually did share. 
                        // Perhaps close the window w/ requestCloseBrowser().
                                MessengerExtensions.requestCloseBrowser(function success() {
                                 //alert('requestCloseBrowser');
                                 //alert($( "#from_field_id" ).val());
                                 //alert($( "#to_field_id" ).val());
                              }, function error(err) {
                                    alert(err);
                        });             
                       }
                      }, 
                        function(errorCode, errorMessage) {      
                          // An error occurred in the process

                        },
                          message,
                          "current_thread");
         
        }
    </script>


 
 
    <button type="button" id="submit_button" onclick="sendMessage();" style = "margin-left:49.999%;">確定</button>
	
	
</body>
	
</html>
	
